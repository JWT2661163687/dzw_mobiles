<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>

		<style>
			a {
				text-decoration: none;
			}
		</style>
	</head>

	<body>
		<div id="UserVehicleApp">
			<el-row :span="24">
				<el-col :md="2">
					<el-button type="primary" @click="dialogVisible = true">车辆添加</el-button>
				</el-col>
				<el-col :push="14" :md="2" style="margin-top: 10px;"><a href="#">查询内容</a></el-col>
				<el-col :md="6" :push="14">
					<el-col :md="15">
						<el-input placeholder="车辆编号" v-model="veh"></el-input>
					</el-col>
					<el-button type="primary" icon="el-icon-search" @click="queryVehicle" style="margin-left: 5px;">搜索</el-button>
				</el-col>
			</el-row>
			<br />
			<el-dialog title="车辆添加" :visible.sync="dialogVisible" width="50%" :before-close="handleClose">
				<el-form :inline="true" :model="formInline" ref="formInline" :rules="rules" class="demo-form-inline">
					<el-form-item label="客户编号">
						<el-input v-model="formInline.user" placeholder="客户编号"></el-input>
					</el-form-item>
					<el-form-item label="驾驶员">
						<el-input v-model="formInline.user" placeholder="驾驶员"></el-input>
					</el-form-item>
					<el-form-item label="车牌号码">
						<el-select v-model="formInline.region" placeholder="请选择">
							<el-option label="区域一" value="shanghai"></el-option>
							<el-option label="区域二" value="beijing"></el-option>
						</el-select>
					</el-form-item>
					<el-form-item label="车辆品牌">
						<el-select v-model="formInline.region" placeholder="请选择">
							<el-option label="区域一" value="shanghai"></el-option>
							<el-option label="区域二" value="beijing"></el-option>
						</el-select>
					</el-form-item>
					<el-form-item label="车辆型号">
						<!--<el-select v-model="formInline.region" placeholder="车辆型号">
							<el-option label="区域一" value="shanghai"></el-option>
							<el-option label="区域二" value="beijing"></el-option>
						</el-select>-->
						<el-input v-model="formInline.user" placeholder="车辆型号" disabled></el-input>
					</el-form-item>
					<el-form-item label="联系电话">
						<el-input v-model="formInline.user" placeholder="联系电话"></el-input>
					</el-form-item>
					<el-form-item label="归属">
						<el-select v-model="formInline.region" placeholder="请选择">
							<el-option label="个人车" value="1"></el-option>
							<el-option label="公司车" value="2"></el-option>
							<el-option label="租赁车" value="3"></el-option>
						</el-select>
					</el-form-item>
					<el-form-item label="里程">
						<el-input v-model="formInline.user" placeholder="里程"></el-input>
					</el-form-item>
					<el-form-item label="上牌日期">
						<div class="block">
							<el-date-picker v-model="formInline.user" type="date" placeholder="选择日期">
							</el-date-picker>
						</div>
					</el-form-item>
					<el-form-item label="购买日期">
						<div class="block">
							<el-date-picker v-model="formInline.user" type="date" placeholder="选择日期">
							</el-date-picker>
						</div>
					</el-form-item>
				</el-form>
				<span slot="footer" class="dialog-footer">
    				<el-button @click="dialogVisible = false">取 消</el-button>
    				<el-button type="primary" @click="add('formInline')">确 定</el-button>
  				</span>
			</el-dialog>
			<el-dialog title="车辆修改" :visible.sync="dialogVisible1" width="50%" :before-close="handleClose">
				<el-form :inline="true" :model="formInline" ref="formInline" :rules="rules" class="demo-form-inline">
					<el-form-item label="车主" prop="name">
						<el-input v-model="formInline.user" placeholder="车主"></el-input>
					</el-form-item>
					<el-form-item label="驾驶员" prop="name1">
						<el-input v-model="formInline.user" placeholder="驾驶员"></el-input>
					</el-form-item>
					<el-form-item label="车牌号码">
						<el-input v-model="formInline.user" placeholder="车牌号码"></el-input>
					</el-form-item>
					<el-form-item label="联系电话" prop="phone">
						<el-input v-model="formInline.user" placeholder="联系电话"></el-input>
					</el-form-item>
					<el-form-item label="车辆品牌" prop="brand">
						<el-select v-model="formInline.region" placeholder="车辆品牌">
							<el-option label="区域一" value="shanghai"></el-option>
							<el-option label="区域二" value="beijing"></el-option>
						</el-select>
					</el-form-item>
					<el-form-item label="车辆型号" prop="model">
						<el-select v-model="formInline.region" placeholder="车辆型号">
							<el-option label="区域一" value="shanghai"></el-option>
							<el-option label="区域二" value="beijing"></el-option>
						</el-select>
					</el-form-item>
					<el-form-item label="车辆归属">
						<el-select v-model="formInline.region" placeholder="车辆型号">
							<el-option label="个人车" value="shanghai"></el-option>
							<el-option label="公司车" value="beijing"></el-option>
							<el-option label="租赁车" value="beijing"></el-option>
						</el-select>
					</el-form-item>
					<el-form-item label="里程">
						<el-input v-model="formInline.user" placeholder="里程"></el-input>
					</el-form-item>
					<el-form-item label="上牌日期">
						<template>
							<div class="block">
								<el-date-picker v-model="value2" align="right" type="date" placeholder="选择日期" :picker-options="pickerOptions">
								</el-date-picker>
							</div>
						</template>
					</el-form-item>
					<el-form-item label="购买日期">
						<template>
							<div class="block">
								<el-date-picker v-model="value2" align="right" type="date" placeholder="选择日期" :picker-options="pickerOptions">
								</el-date-picker>
							</div>
						</template>
					</el-form-item>
				</el-form>
				<span slot="footer" class="dialog-footer">
    				<el-button @click="dialogVisible = false">取 消</el-button>
    				<el-button type="primary" @click="add('formInline')">确 定</el-button>
  				</span>
			</el-dialog>
			<el-row :span="24">
				<template>
					<el-table :data="vehicle" height="250" border style="width: 100%;" @row-dblclick="client">
						<el-table-column prop="" label="序号">
							<template slot-scope="scope">
								<span>{{scope.$index+1}}</span>
							</template>
						</el-table-column>
						<el-table-column prop="vid" label="车辆编号">
						</el-table-column>
						<el-table-column prop="cid" label="客户编号">
						</el-table-column>
						<el-table-column prop="vdriver" label="驾驶员">
						</el-table-column>
						<el-table-column prop="vlicense" label="车牌号码">
						</el-table-column>
						<el-table-column prop="vbrand" label="车辆品牌">
						</el-table-column>
						<el-table-column prop="vmodel" label="车辆型号">
						</el-table-column>
						<el-table-column prop="vphone" label="联系电话">
						</el-table-column>
						<el-table-column prop="vaffiliation" label="车辆归属">
						</el-table-column>
						<el-table-column prop="vmileage" label="里程(km)">
						</el-table-column>
						<el-table-column prop="registereddate" label="上牌日期" width="200">
						</el-table-column>
						<el-table-column prop="purchasedate" label="购买日期" width="200">
						</el-table-column>
						<el-table-column prop="" label="操作" width="180">
							<template slot-scope="scope">
								<el-button type="success" icon="el-icon-edit" title="修改" @click="dialogVisible1 = true"></el-button>
								<el-button type="primary" icon="el-icon-delete" title="删除"></el-button>
							</template>
						</el-table-column>
					</el-table>
				</template>
			</el-row>
			<br />
			<br />
			<el-row>
				<el-tabs type="border-card">
					<el-tab-pane label="用户管理">
						<template>
							<el-table :data="client1" height="250" border style="width: 100%">
								<el-table-column prop="" label="序号">
									<template slot-scope="scope">
										<span>{{scope.$index+1}}</span>
									</template>
								</el-table-column>
								<el-table-column prop="cid" label="客户编号">
								</el-table-column>
								<el-table-column prop="cname" label="客户名称">
								</el-table-column>
								<el-table-column prop="cphone" label="手机号">
								</el-table-column>
								<el-table-column prop="createdate" label="创建时间">
								</el-table-column>
								<el-table-column label="客户等级">
									<template slot-scope="scope">
										<span v-if="scope.row.cgrade==1">普通用户</span>
										<span v-if="scope.row.cgrade==2">会员用户</span>
									</template>
								</el-table-column>
								<el-table-column prop="climit" label="用户额度">
								</el-table-column>
								<el-table-column prop="cintegral" label="积分">
								</el-table-column>
								<el-table-column prop="cremark" label="备注">
								</el-table-column>

							</el-table>
						</template>
					</el-tab-pane>
				</el-tabs>
			</el-row>
		</div>
	</body>
	<script>
		var UserVehicleApp = new Vue({
			el: "#UserVehicleApp",
			data: {
				dialogVisible1: false,
				dialogVisible: false,
				veh: "",
				tableData: [{
					date: '2016-05-03',
					name: '王小虎',
					address: '上海市普陀区金沙江路 1518 弄'
				}, {
					date: '2016-05-02',
					name: '王小虎',
					address: '上海市普陀区金沙江路 1518 弄'
				}, {
					date: '2016-05-04',
					name: '王小虎',
					address: '上海市普陀区金沙江路 1518 弄'
				}, {
					date: '2016-05-01',
					name: '王小虎',
					address: '上海市普陀区金沙江路 1518 弄'
				}, {
					date: '2016-05-08',
					name: '王小虎',
					address: '上海市普陀区金沙江路 1518 弄'
				}, {
					date: '2016-05-06',
					name: '王小虎',
					address: '上海市普陀区金沙江路 1518 弄'
				}, {
					date: '2016-05-07',
					name: '王小虎',
					address: '上海市普陀区金沙江路 1518 弄'
				}],
				formInline: {
					user: '',
					region: ''
				},
				pickerOptions: {
					disabledDate(time) {
							return time.getTime() > Date.now();
						},
						shortcuts: [{
							text: '今天',
							onClick(picker) {
								picker.$emit('pick', new Date());
							}
						}, {
							text: '昨天',
							onClick(picker) {
								const date = new Date();
								date.setTime(date.getTime() - 3600 * 1000 * 24);
								picker.$emit('pick', date);
							}
						}, {
							text: '一周前',
							onClick(picker) {
								const date = new Date();
								date.setTime(date.getTime() - 3600 * 1000 * 24 * 7);
								picker.$emit('pick', date);
							}
						}]
				},
				value2: '',
				rules: {
					name: [{
						required: true,
						message: '请输入车主名称',
						trigger: 'blur'
					}],
					name1: [{
						required: true,
						message: '请输入驾驶员名称',
						trigger: 'blur'
					}],
					brand: [{
						required: true,
						message: '请选择车辆品牌',
						trigger: 'blur'
					}],
					model: [{
						required: true,
						message: '请选择车辆型号',
						trigger: 'blur'
					}],
					phone: [{
						required: true,
						message: '请输入联系电话',
						trigger: 'blur'
					}]
				},
				vehicle:[],
				client1:[]
			},
			methods: {
				//查询车辆信息
				queryVehicle() {},
					handleClose(done) {
						this.$confirm('确认关闭？')
							.then(_ => {
								done();
								this.$message({
									message: '关闭成功!',
									type: 'success'
								});
							})
							.catch(_ => {});
					},
					add(a) {
						this.$refs[a].validate((valid) => {
							if (valid) {
							} else {
								console.log('error submit!!');
								return false;
							}
						});
					},
					//根据条件查询车辆信息
					queryVehicle(){
						var veh1 = 0;
						let _this = this;
						if(this.veh!=""){
							veh1 = this.veh;
						}
						axios.get(`http://127.0.0.1:8080/dzw_moblie/api/vehicles/${veh1}`).then(function(resp){
							_this.vehicle = resp.data;
						})
					},
					//双击车辆显示对应的客户信息
					client(row){
						let _this = this;
						axios.get(`http://127.0.0.1:8080/dzw_moblie/api/vehicles/client/${row.cid}`).then(function(resp){
							_this.client1 = resp.data;
						})
					}
			},
			mounted(){
				this.queryVehicle();
			}
		})
	</script>

</html>